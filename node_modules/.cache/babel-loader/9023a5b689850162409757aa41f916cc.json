{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Kaustubh Sinha\\\\Desktop\\\\bookkart\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:\\\\Users\\\\Kaustubh Sinha\\\\Desktop\\\\bookkart\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Kaustubh Sinha\\\\Desktop\\\\bookkart\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Kaustubh Sinha\\\\Desktop\\\\bookkart\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{v4 as uuidv4}from'uuid';import{API,graphqlOperation,Storage}from\"aws-amplify\";import{AmplifyAuthenticator,AmplifySignOut}from'@aws-amplify/ui-react';import{createBook}from'../api/mutations';import config from'../aws-exports';var region=config.aws_user_files_s3_bucket_region,bucket=config.aws_user_files_s3_bucket;var Admin=function Admin(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState({title:\"\",description:\"\",image:\"\",author:\"\",price:\"\"}),_useState4=_slicedToArray(_useState3,2),bookDetails=_useState4[0],setBookDetails=_useState4[1];var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;if(!(!bookDetails.title||!bookDetails.price)){_context.next=4;break;}return _context.abrupt(\"return\");case 4:_context.next=6;return API.graphql(graphqlOperation(createBook,{input:bookDetails}));case 6:setBookDetails({title:\"\",description:\"\",image:\"\",author:\"\",price:\"\"});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.log('error creating todo:',_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var handleImageUpload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var file,extension,name,key,url,_image;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();file=e.target.files[0];extension=file.name.split(\".\")[1];name=file.name.split(\".\")[0];key=\"images/\".concat(uuidv4()).concat(name,\".\").concat(extension);url=\"https://\".concat(bucket,\".s3.\").concat(region,\".amazonaws.com/public/\").concat(key);_context2.prev=6;_context2.next=9;return Storage.put(key,file,{level:'public',contentType:file.type});case 9:_context2.next=11;return Storage.get(key,{level:'public'});case 11:_image=_context2.sent;setImage(_image);setBookDetails(_objectSpread(_objectSpread({},bookDetails),{},{image:url}));_context2.next=19;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](6);console.log(_context2.t0);case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[6,16]]);}));return function handleImageUpload(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"section\",{className:\"admin-wrapper\"},/*#__PURE__*/React.createElement(AmplifyAuthenticator,null,/*#__PURE__*/React.createElement(\"section\",null,/*#__PURE__*/React.createElement(\"header\",{className:\"form-header\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Add New Book\"),/*#__PURE__*/React.createElement(AmplifySignOut,null)),/*#__PURE__*/React.createElement(\"form\",{className:\"form-wrapper\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-image\"},image?/*#__PURE__*/React.createElement(\"img\",{className:\"image-preview\",src:image,alt:\"\"}):/*#__PURE__*/React.createElement(\"input\",{type:\"file\",accept:\"image/jpg\",onChange:function onChange(e){return handleImageUpload(e);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-fields\"},/*#__PURE__*/React.createElement(\"div\",{className:\"title-form\"},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"title\"},\"Title\")),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"input\",{name:\"email\",type:\"title\",placeholder:\"Type the title\",onChange:function onChange(e){return setBookDetails(_objectSpread(_objectSpread({},bookDetails),{},{title:e.target.value}));},required:true}))),/*#__PURE__*/React.createElement(\"div\",{className:\"description-form\"},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"description\"},\"Description\")),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"textarea\",{name:\"description\",type:\"text\",rows:\"8\",placeholder:\"Type the description of the book\",onChange:function onChange(e){return setBookDetails(_objectSpread(_objectSpread({},bookDetails),{},{description:e.target.value}));},required:true}))),/*#__PURE__*/React.createElement(\"div\",{className:\"author-form\"},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"author\"},\"Author\")),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"input\",{name:\"author\",type:\"text\",placeholder:\"Type the author's name\",onChange:function onChange(e){return setBookDetails(_objectSpread(_objectSpread({},bookDetails),{},{author:e.target.value}));},required:true}))),/*#__PURE__*/React.createElement(\"div\",{className:\"price-form\"},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"price\"},\"Price ($)\"),/*#__PURE__*/React.createElement(\"input\",{name:\"price\",type:\"text\",placeholder:\"What is the Price of the book (USD)\",onChange:function onChange(e){return setBookDetails(_objectSpread(_objectSpread({},bookDetails),{},{price:e.target.value}));},required:true}))),/*#__PURE__*/React.createElement(\"div\",{className:\"featured-form\"},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"label\",null,\"Featured?\"),/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",className:\"featured-checkbox\",checked:bookDetails.featured,onChange:function onChange(){return setBookDetails(_objectSpread(_objectSpread({},bookDetails),{},{featured:!bookDetails.featured}));}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"submit-form\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn\",type:\"submit\"},\"Submit\")))))));};export default Admin;","map":{"version":3,"sources":["C:/Users/Kaustubh Sinha/Desktop/bookkart/src/pages/Admin.js"],"names":["React","useState","v4","uuidv4","API","graphqlOperation","Storage","AmplifyAuthenticator","AmplifySignOut","createBook","config","region","aws_user_files_s3_bucket_region","bucket","aws_user_files_s3_bucket","Admin","image","setImage","title","description","author","price","bookDetails","setBookDetails","handleSubmit","e","preventDefault","graphql","input","console","log","handleImageUpload","file","target","files","extension","name","split","key","url","put","level","contentType","type","get","value","featured"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { API, graphqlOperation, Storage } from \"aws-amplify\";\r\nimport { AmplifyAuthenticator, AmplifySignOut } from '@aws-amplify/ui-react';\r\nimport { createBook } from '../api/mutations'\r\nimport config from '../aws-exports'\r\n\r\nconst {\r\n    aws_user_files_s3_bucket_region: region,\r\n    aws_user_files_s3_bucket: bucket\r\n} = config\r\n\r\n\r\nconst Admin = () => {\r\n    const [image, setImage] = useState(null);\r\n    const [bookDetails, setBookDetails] = useState({ title: \"\", description: \"\", image: \"\", author: \"\", price: \"\" });\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            if (!bookDetails.title || !bookDetails.price) return\r\n            await API.graphql(graphqlOperation(createBook, { input: bookDetails }))\r\n            setBookDetails({ title: \"\", description: \"\", image: \"\", author: \"\", price: \"\" })\r\n        } catch (err) {\r\n            console.log('error creating todo:', err)\r\n        }\r\n    }\r\n\r\n    const handleImageUpload = async (e) => {\r\n        e.preventDefault();\r\n        const file = e.target.files[0];\r\n        const extension = file.name.split(\".\")[1];\r\n        const name = file.name.split(\".\")[0];\r\n        const key = `images/${uuidv4()}${name}.${extension}`;\r\n        const url = `https://${bucket}.s3.${region}.amazonaws.com/public/${key}`\r\n        try {\r\n            // Upload the file to s3 with public access level. \r\n            await Storage.put(key, file, {\r\n                level: 'public',\r\n                contentType: file.type\r\n            });\r\n            // Retrieve the uploaded file to display\r\n            const image = await Storage.get(key, { level: 'public' })\r\n            setImage(image);\r\n            setBookDetails({ ...bookDetails, image: url });\r\n        } catch (err) {\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <section className=\"admin-wrapper\">\r\n            <AmplifyAuthenticator>\r\n                <section>\r\n                    <header className=\"form-header\">\r\n                        <h3>Add New Book</h3>\r\n                        <AmplifySignOut></AmplifySignOut>\r\n                    </header>\r\n                    <form className=\"form-wrapper\" onSubmit={handleSubmit}>\r\n                        <div className=\"form-image\">\r\n                            {image ? <img className=\"image-preview\" src={image} alt=\"\" /> : <input\r\n                                type=\"file\"\r\n                                accept=\"image/jpg\"\r\n                                onChange={(e) => handleImageUpload(e)} />}\r\n\r\n                        </div>\r\n                        <div className=\"form-fields\">\r\n                            <div className=\"title-form\">\r\n                                <p><label htmlFor=\"title\">Title</label></p>\r\n                                <p><input\r\n                                    name=\"email\"\r\n                                    type=\"title\"\r\n                                    placeholder=\"Type the title\"\r\n                                    onChange={(e) => setBookDetails({ ...bookDetails, title: e.target.value })}\r\n                                    required\r\n                                /></p>\r\n                            </div>\r\n                            <div className=\"description-form\">\r\n                                <p><label htmlFor=\"description\">Description</label></p>\r\n                                <p><textarea\r\n                                    name=\"description\"\r\n                                    type=\"text\"\r\n                                    rows=\"8\"\r\n                                    placeholder=\"Type the description of the book\"\r\n                                    onChange={(e) => setBookDetails({ ...bookDetails, description: e.target.value })}\r\n                                    required\r\n                                /></p>\r\n                            </div>\r\n                            <div className=\"author-form\">\r\n                                <p><label htmlFor=\"author\">Author</label></p>\r\n                                <p><input\r\n                                    name=\"author\"\r\n                                    type=\"text\"\r\n                                    placeholder=\"Type the author's name\"\r\n                                    onChange={(e) => setBookDetails({ ...bookDetails, author: e.target.value })}\r\n                                    required\r\n                                /></p>\r\n                            </div>\r\n                            <div className=\"price-form\">\r\n                                <p><label htmlFor=\"price\">Price ($)</label>\r\n                                    <input\r\n                                        name=\"price\"\r\n                                        type=\"text\"\r\n                                        placeholder=\"What is the Price of the book (USD)\"\r\n                                        onChange={(e) => setBookDetails({ ...bookDetails, price: e.target.value })}\r\n                                        required\r\n                                    /></p>\r\n                            </div>\r\n                            <div className=\"featured-form\">\r\n                                <p><label>Featured?</label>\r\n                                    <input type=\"checkbox\"\r\n                                        className=\"featured-checkbox\"\r\n                                        checked={bookDetails.featured}\r\n                                        onChange={() => setBookDetails({ ...bookDetails, featured: !bookDetails.featured })}\r\n                                    />\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"submit-form\">\r\n                                <button className=\"btn\" type=\"submit\">Submit</button>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n                </section>\r\n            </AmplifyAuthenticator>\r\n        </section>\r\n    )\r\n}\r\n\r\nexport default Admin\r\n"]},"metadata":{},"sourceType":"module"}
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var constants_1 = require("./constants");
var service_error_classification_1 = require("@aws-sdk/service-error-classification");
exports.defaultRetryDecider = function (error) {
    if (!error) {
        return false;
    }
    if (error.connectionError) {
        return true;
    }
    if (hasMetadata(error) &&
        error.$metadata.httpStatusCode &&
        constants_1.RETRYABLE_STATUS_CODES.has(error.$metadata.httpStatusCode)) {
        return true;
    }
    return (service_error_classification_1.isStillProcessingError(error) ||
        service_error_classification_1.isThrottlingError(error) ||
        service_error_classification_1.isClockSkewError(error));
};
function hasMetadata(error) {
    return error === null || error === void 0 ? void 0 : error.$metadata;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmV0cnlEZWNpZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL3JldHJ5RGVjaWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlDQUFxRDtBQUNyRCxzRkFJK0M7QUFHbEMsUUFBQSxtQkFBbUIsR0FBRyxVQUFDLEtBQWU7SUFDakQsSUFBSSxDQUFDLEtBQUssRUFBRTtRQUNWLE9BQU8sS0FBSyxDQUFDO0tBQ2Q7SUFFRCxJQUFJLEtBQUssQ0FBQyxlQUFlLEVBQUU7UUFDekIsT0FBTyxJQUFJLENBQUM7S0FDYjtJQUVELElBQ0UsV0FBVyxDQUFDLEtBQUssQ0FBQztRQUNsQixLQUFLLENBQUMsU0FBUyxDQUFDLGNBQWM7UUFDOUIsa0NBQXNCLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLEVBQzFEO1FBQ0EsT0FBTyxJQUFJLENBQUM7S0FDYjtJQUVELE9BQU8sQ0FDTCxxREFBc0IsQ0FBQyxLQUFLLENBQUM7UUFDN0IsZ0RBQWlCLENBQUMsS0FBSyxDQUFDO1FBQ3hCLCtDQUFnQixDQUFDLEtBQUssQ0FBQyxDQUN4QixDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUYsU0FBUyxXQUFXLENBQUMsS0FBVTtJQUM3QixPQUFPLEtBQUssYUFBTCxLQUFLLHVCQUFMLEtBQUssQ0FBRSxTQUFTLENBQUM7QUFDMUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJFVFJZQUJMRV9TVEFUVVNfQ09ERVMgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7XG4gIGlzQ2xvY2tTa2V3RXJyb3IsXG4gIGlzU3RpbGxQcm9jZXNzaW5nRXJyb3IsXG4gIGlzVGhyb3R0bGluZ0Vycm9yXG59IGZyb20gXCJAYXdzLXNkay9zZXJ2aWNlLWVycm9yLWNsYXNzaWZpY2F0aW9uXCI7XG5pbXBvcnQgeyBNZXRhZGF0YUJlYXJlciwgU2RrRXJyb3IgfSBmcm9tIFwiQGF3cy1zZGsvdHlwZXNcIjtcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRSZXRyeURlY2lkZXIgPSAoZXJyb3I6IFNka0Vycm9yKSA9PiB7XG4gIGlmICghZXJyb3IpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoZXJyb3IuY29ubmVjdGlvbkVycm9yKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBpZiAoXG4gICAgaGFzTWV0YWRhdGEoZXJyb3IpICYmXG4gICAgZXJyb3IuJG1ldGFkYXRhLmh0dHBTdGF0dXNDb2RlICYmXG4gICAgUkVUUllBQkxFX1NUQVRVU19DT0RFUy5oYXMoZXJyb3IuJG1ldGFkYXRhLmh0dHBTdGF0dXNDb2RlKVxuICApIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgaXNTdGlsbFByb2Nlc3NpbmdFcnJvcihlcnJvcikgfHxcbiAgICBpc1Rocm90dGxpbmdFcnJvcihlcnJvcikgfHxcbiAgICBpc0Nsb2NrU2tld0Vycm9yKGVycm9yKVxuICApO1xufTtcblxuZnVuY3Rpb24gaGFzTWV0YWRhdGEoZXJyb3I6IGFueSk6IGVycm9yIGlzIE1ldGFkYXRhQmVhcmVyIHtcbiAgcmV0dXJuIGVycm9yPy4kbWV0YWRhdGE7XG59XG4iXX0=
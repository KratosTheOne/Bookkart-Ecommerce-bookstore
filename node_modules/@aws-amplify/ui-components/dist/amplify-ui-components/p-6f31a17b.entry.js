import{r as t,h as i}from"./p-66cb0d90.js";import{Logger as s,I18n as e}from"@aws-amplify/core";import{M as h}from"./p-417bb5ea.js";import{T as a}from"./p-cfe3631f.js";import{N as l,c as n,d as o}from"./p-a83a77db.js";import{Auth as r}from"@aws-amplify/auth";const u=new s("SelectMFAType");class p{constructor(i){t(this,i),this.handleSubmit=t=>this.verify(t),this.TOTPSetup=!1,this.selectMessage=null,this.MFAMethod=null,this.isTOTP=!1,this.isNoMFA=!1,this.isSMS=!1,this.loading=!1}handleRadioButtonChange(t){this.TOTPSetup=!1,this.selectMessage=null,this.isNoMFA=!1,this.isTOTP=!1,this.isSMS=!1;const{value:i,type:s,checked:e}=t.target,a=["radio","checkbox"].includes(s);i===h.SMS&&a&&(this.isSMS=e),i===h.TOTP&&a&&(this.isTOTP=e),i===h.NOMFA&&a&&(this.isNoMFA=e)}async verify(t){t&&t.preventDefault(),u.debug("MFA Type Values",{TOTP:this.isTOTP,SMS:this.isSMS,"No MFA":this.isNoMFA}),this.isTOTP?this.MFAMethod=h.TOTP:this.isSMS?this.MFAMethod=h.SMS:this.isNoMFA&&(this.MFAMethod=h.NOMFA);const i=this.authData;if(!r||"function"!=typeof r.setPreferredMFA)throw new Error(l);this.loading=!0;try{const t=await r.setPreferredMFA(i,this.MFAMethod);u.debug("Set Preferred MFA Succeeded",t),this.selectMessage=`${e.get(a.SUCCESS_MFA_TYPE)} ${this.MFAMethod}`}catch(s){const{message:t}=s;t===n||t===o?(this.TOTPSetup=!0,this.selectMessage=e.get(a.SETUP_TOTP_REQUIRED)):(u.debug("Set Preferred MFA failed",s),this.selectMessage=e.get(a.UNABLE_TO_SETUP_MFA_AT_THIS_TIME))}finally{this.loading=!1}}contentBuilder(){if(!this.MFATypes||Object.keys(this.MFATypes).length<2)return u.debug(e.get(a.LESS_THAN_TWO_MFA_VALUES_MESSAGE)),i("div",null,i("a",null,e.get(a.LESS_THAN_TWO_MFA_VALUES_MESSAGE)));const{SMS:t,TOTP:s,Optional:h}=this.MFATypes;return i("amplify-form-section",{submitButtonText:e.get(a.SELECT_MFA_TYPE_SUBMIT_BUTTON_TEXT),headerText:e.get(a.SELECT_MFA_TYPE_HEADER_TEXT),handleSubmit:t=>this.handleSubmit(t),loading:this.loading},t?i("amplify-radio-button",{key:"sms",name:"MFAType",value:"SMS",label:"SMS",handleInputChange:t=>this.handleRadioButtonChange(t)}):null,s?i("amplify-radio-button",{key:"totp",name:"MFAType",value:"TOTP",label:"TOTP",handleInputChange:t=>this.handleRadioButtonChange(t)}):null,h?i("amplify-radio-button",{key:"noMFA",name:"MFAType",value:"NOMFA",label:"No MFA",handleInputChange:t=>this.handleRadioButtonChange(t)}):null)}render(){return i("div",null,this.contentBuilder(),this.TOTPSetup?i("amplify-totp-setup",{user:this.authData}):null)}}export{p as amplify_select_mfa_type}